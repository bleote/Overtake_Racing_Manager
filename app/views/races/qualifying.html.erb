<div class="race-qualy pt-2 m-2 rounded border border-white">
  <div class="qualifying-result-page d-flex justify-content-between align-items-center mx-3">
    <div class="d-flex row">
      <h1>Qualifying Session</h1>
      <div class="all-qs">
        <div id="q1-results" class="q1-results text-start mx-2">
        <!-- Display lap times for Q1 drivers -->
          <h3>Q1 Lap Times</h3>
          <% @q1_lap_times.each_with_index do |lap_time, index| %>
            <!-- Display driver's lap time information -->
            <% driver_name = lap_time.driver.driver_name %>
            <% lap_time_style = index >= @q1_lap_times.length - 5 ? 'color: #df0000;' : '' %>
            <p id="q1-lap-time-<%= index %>" style="display: none; <%= lap_time_style %>"><%= driver_name %>: <%= format_lap_time(lap_time.time) %></p>
          <% end %>
        </div>

        <div class="py-2">
        <button id="start-q2-btn" class="btn btn-primary" style="display: none;">Start Q2</button>
        </div>

        <div id="q2-results" class="q2-results text-start mx-2" style="display: none;">
        <!-- Display lap times for Q2 drivers -->
          <h3>Q2 Lap Times</h3>
          <% @q2_lap_times.each_with_index do |lap_time, index| %>
            <!-- Display driver's lap time information -->
            <% driver_name = lap_time.driver.driver_name %>
            <% lap_time_style = index >= @q2_lap_times.length - 5 ? 'color: #df0000;' : '' %>
            <p id="q2-lap-time-<%= index %>" style="display: none; <%= lap_time_style %>"><%= driver_name %>: <%= format_lap_time(lap_time.time) %></p>
          <% end %>
        </div>

        <div class="py-2">
        <button id="start-q3-btn" class="btn btn-primary" style="display: none;">Start Q3</button>
        </div>

        <div id="q3-results" class="q3-results text-start mx-2" style="display: none;">
        <!-- Display lap times for Q3 drivers -->
          <h3>Q3 Lap Times</h3>
          <% @q3_lap_times.each_with_index do |lap_time, index| %>
            <!-- Display driver's lap time information -->
            <p id="q3-lap-time-<%= index %>" style="display: none;"><%= lap_time.driver.driver_name %>: <%= format_lap_time(lap_time.time) %></p>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// Get references to the elements
var startQ2Button = document.getElementById("start-q2-btn");
var startQ3Button = document.getElementById("start-q3-btn");
var q1ResultsContainer = document.getElementById("q1-results");
var q2ResultsContainer = document.getElementById("q2-results");
var q3ResultsContainer = document.getElementById("q3-results");

// Attach event listeners to the buttons
startQ2Button.addEventListener("click", showQ2);
startQ3Button.addEventListener("click", showQ3);

// Function to switch to Q2 results
function showQ2() {
  q1ResultsContainer.style.display = "none";
  startQ2Button.style.display = "none";
  q2ResultsContainer.style.display = "block";
  revealLapTimes(q2ResultsContainer, startQ3Button);
}

// Function to switch to Q3 results
function showQ3() {
  q2ResultsContainer.style.display = "none";
  startQ3Button.style.display = "none";
  q3ResultsContainer.style.display = "block";
  revealLapTimes(q3ResultsContainer, null);
}

// Function to reveal lap times line by line
function revealLapTimes(container, nextButton) {
  var lapTimes = container.querySelectorAll("p");
  var index = 0;
  var interval = setInterval(function() {
    lapTimes[index].style.display = "block";
    index++;
    if (index === lapTimes.length) {
      clearInterval(interval);
      if (nextButton) {
        nextButton.style.display = "block";
      }
    }
  }, 100); // Adjust the interval duration (in milliseconds) as desired
}

// Initial reveal of Q1 lap times
revealLapTimes(q1ResultsContainer, startQ2Button);
</script>
